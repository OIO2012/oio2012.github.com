<html><!-- строчка рекламы by.ru -->
<script language="JavaScript" type="text/javascript" src="../../../more.by.ru/up/up.js-1937944448" tppabs="http://more.by.ru/up/up.js?1937944448"></script>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<!--
This document was converted from RTF source: 
By rtftohtml 4.17
See http://www.sunpack.com/RTF
Filename:HardDrive:Desktop Folder:0672315947:emacs.rtf
Application Directory:HardDrive:Desktop Folders:Converters:ERL-SEU(4.17):r2h
Subject:
Author:enduser
Operator:End User
Document Comments:
Version Comments:
Comments:
Keywords:
Translation Date:08/11/1999
Translation Time:22:03:41
Translation Platform:MacOS
Number of Output files:226
This File:HardDrive:Desktop Folder:0672315947:emacs019.htm
SplitDepth=2
SkipNavPanel=1
SkipLeadingToc=0
SkipTrailingToc=1
GenContents=1
GenFrames=0
GenIndex=1
-->
<HEAD lang="en"><LINK rel="stylesheet" href="graphics/pkbstyle.css" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/pkbstyle.css">
<META NAME="CATEGORY" CONTENT="0672315947">
<META NAME="BOOKTITLE" CONTENT="Sams Teach Yourself Emacs in 24 Hours">
<TITLE>Hour 2: Using Emacs in Microsoft Windows: Things NT Emacs Does Not Do Well</TITLE>




</SCRIPT><!--Begin Popup Script-->
<SCRIPT LANGUAGE="JavaScript">
<!--
function popUp(pPage) {
 figLoc = '' + document.location;
 if (figLoc.indexOf('/') == -1 && figLoc.indexOf('\\') >= 0) {
   slash = '\\';
 } else {
   slash = '/';
 }
 openLoc = figLoc.substring(0, figLoc.lastIndexOf(slash) + 1);
 while (pPage.substring(0,3) == '../') {
   openLoc = openLoc.substring(0, openLoc.lastIndexOf(slash, openLoc.length - 2) + 1);
   pPage = pPage.substring(3, pPage.length + 1);
 }
 popUpWin = window.open('','popWin','resizable=1,scrollbars=1,location=0,toolbar=0,width=525,height=394');
 figDoc = popUpWin.document;
 zhtm= '<HTML><HEAD><TITLE>' + pPage + '</TITLE>';
 zhtm += '</head>';
 zhtm += '<BODY bgcolor="#FFFFFF">';
 zhtm += '<IMG SRC="' + openLoc + pPage + '">';
 zhtm += '<P><B>' + pPage.substring(pPage.lastIndexOf('/') + 1, pPage.length) + '</B> ';
 zhtm += '</BODY></HTML>';
 figDoc.write(zhtm);
 figDoc.close();
}
// modified 3.1.99 RWE v4.1 -->
</SCRIPT>

<!--End Popup Script--></HEAD>

<BODY bgcolor=#FFFFFF >
<TABLE border="0" width="99%" cellspacing="0" cellpadding="3">
  <TR> 
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif"  bgcolor="#666699"> 
      <P> <FONT color="#FFFFFF"><B>Sams Teach Yourself Emacs<FONT size="1"></FONT> 
        in 24 Hours</B> </FONT></P>
    </TD>
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif" bgcolor="#666699"><FONT size="2"><IMG src="../style/dot.gif" tppabs="http://freebooks.by.ru/view/style/dot.gif" width="10" height="1"></FONT></TD>
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif" bgcolor="#666699" nowrap align="right"> 
      <P><A href="index.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/index.htm"><FONT size="2" color="#FFFFFF">Contents</FONT></A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="bkindex.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/bkindex.htm"><FONT size="2" color="#FFFFFF">Index</FONT></A></P>
    </TD>
  </TR>
  <TR> 
    <TD bgcolor="#AAAAAA" height="16"> 
      <P><FONT size="2">Hour 2: Using Emacs in Microsoft Windows</FONT></P>
    </TD>
    <TD bgcolor="#AAAAAA" height="16"><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
    <TD bgcolor="#AAAAAA" height="16" align="right" nowrap> 
      <P><FONT size="2"><A href="emacs010.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs010.htm"><IMG src="graphics/prev-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/prev-on.gif" width="7" height="5" border="0">Previous 
        Hour</A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="emacs025.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs025.htm">Next 
        Hour<IMG src="graphics/next-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/next-on.gif" width="7" height="5" border="0"></A></FONT></P>
    </TD>
  </TR>
  <TR> 
    <TD bgcolor="#DDDDDD"> 
      <TABLE border="0" cellspacing="0" cellpadding="0" dwcopytype="CopyTableRow">
        <TR valign="top"> 
          <TD> 
            <P></P>
            <P><FONT size="2">Sections in this Hour:</FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs016.htm#c1" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs016.htm#c1">What 
              Is NT Emacs?</A> </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs020.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs020.htm">How to 
              Tell Which Computer You Are On</A> </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs017.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs017.htm">Needed 
              Directories</A></FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs021.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs021.htm">Summary</A> 
              </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs018.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs018.htm">Setting 
              Up for Printing</A> </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs022.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs022.htm">Q&amp;A</A> 
              </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1">Things NT Emacs Does Not Do Well 
              </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs023.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs023.htm">Exercises</A> 
              </FONT></P>
          </TD>
        </TR>
      </TABLE>
    </TD>
    <TD bgcolor="#DDDDDD">&nbsp;</TD>
    <TD bgcolor="#DDDDDD" align="right" nowrap valign="bottom"> 
      <P class="navigation"><FONT size="2"><A href="emacs018.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs018.htm"><IMG src="graphics/prev-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/prev-on.gif" width="7" height="5" border="0">Previous 
        Section</A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="emacs020.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs020.htm">Next 
        Section<IMG src="graphics/next-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/next-on.gif" width="7" height="5" border="0"></A></FONT></P>
    </TD>
  </TR>
</TABLE>
<H2><A name="c1"></A> Things NT Emacs Does Not Do Well </H2>
<TABLE border="0" cellspacing="0" cellpadding="0">
  <TR valign="top"> 
    <TD> 
      <P class="navigation"><FONT size="1"><A href="#Heading62">Files with Streams</A></FONT></P>
    </TD>
  </TR>
  <TR valign="top"> 
    <TD> 
      <P class="navigation"><FONT size="1"><A href="#Heading63">ange-FTP</A></FONT></P>
    </TD>
  </TR>
  <TR valign="top"> 
    <TD> 
      <P class="navigation"><FONT size="1"><A href="#Heading64">command.com</A></FONT></P>
    </TD>
  </TR>
</TABLE>
<BR>
<P><FONT size=2>Windows
NT is not<A name="Index513"></A><A name="Index514"></A>
UNIX, and there are some things it simply does not do according to the UNIX
philosophy. When Emacs runs up against those things, it has problems. Often
there is a workaround, and the following sections cover a few of <A name="Index515"></A><A name="Index516"></A>them.</FONT></P>
<A name="Heading62"></A><H3>
Files
with Streams
</H3>
<P><FONT size=2>Windows
NT has<A name="Index517"></A><A name="Index518"></A>
a concept called 
<I>named
streams
</I>.
This allows a program to treat one file as several logical files within the one
file. NT Emacs does not support named streams in any way. In fact, if you
change a text file with one or more named streams, the named streams will be<A name="Index519"></A><A name="Index520"></A>
destroyed.
</FONT></P>
<A name="Heading63"></A><H3>
ange-FTP</H3>
<P><FONT size=2>Emacs
has a neat<A name="Index521"></A><A name="Index522"></A><A name="Index523"></A>
facility called ange-FTP. This lets you edit a file on a remote computer via
the FTP protocol. If you can read the file and write to it via FTP, you can
edit it with Emacs, and Emacs will hide most of the FTP stuff for you. Versions
of NT Emacs prior to 20.3.1 had problems using Windows&#039;s native FTP
client. 20.3.1 works with the Windows client, so that might be a good reason to
upgrade from a prior version.
</FONT></P><P><FONT size=2>One
problem you will have with ange-FTP is that ange-FTP&#039;s filename code does
not understand MS-DOS drive letters such as 
<SPAN class=compcode>C:</SPAN>.
So files on a Windows computer might not be accessible to Emacs even though the
FTP server has permission to make the file available.
</FONT></P><P><FONT size=2>One
workaround is to make the file available as a network share. You can then
access the file through the share name. After you have typed in the UNC name of
the share (
<SPAN class=compcode>\\server\files\</SPAN>,
for example), tab completion works as it does with local<A name="Index524"></A><A name="Index525"></A><A name="Index526"></A>
files.
</FONT></P>
<A name="Heading64"></A><H3>
command.com</H3>
<P><FONT size=2>One
thing users<A name="Index527"></A><A name="Index528"></A><A name="Index529"></A><A name="Index530"></A><A name="Index531"></A>
of Windows 95/98 should beware: 
<SPAN class=compcode>command.com</SPAN>
(the standard Windows 95/98 command-line shell) does not support multitasking
or multiple shell buffers under Emacs. 
<SPAN class=compcode>command.com</SPAN>
does not respond well to 
<SPAN class=compcode>C-c</SPAN>
commands, which is what Emacs uses to shut down shells that it runs. The result
might be zombie copies of 
<SPAN class=compcode>command.com</SPAN>
that make it impossible to shut down Windows gracefully.
</FONT></P><P><FONT size=2>There
are two solutions. The most UNIX-like and most effective is to install the
Cygnus Bash port. BASH is a shell found on UNIX. It is the standard shell for
Linux, for  example. The Cygnus port of Bash is primarily intended for Windows
NT, and some users have reported problems with it on Windows 95. It is probably
the UNIX shell most used by NT Emacs users.
</FONT></P><P><FONT size=2>If
you use 
<SPAN class=compcode>command.com</SPAN>,
note that the end-of-line handling code in Emacs version 20.3.1 prevents 
<SPAN class=compcode>command.com</SPAN>
from being used as the interactive shell on Win95 out of the box. To use 
<SPAN class=compcode>command.com</SPAN>
as <A name="Index532"></A><A name="Index533"></A><A name="Index534"></A><A name="Index535"></A><A name="Index536"></A>your
shell, place the following in your startup file:
</FONT></P>

<PRE class="compcode"><FONT size=3>
<SPAN class=compcode>     (setq process-coding-system-alist </SPAN>
<SPAN class=compcode>           &#039;((&quot;cmdproxy&quot; . (raw-text-dos . raw-text-dos)))) </SPAN>
</FONT></PRE>
<P><FONT size=2>Also,
make sure you have 
<SPAN class=compcode>msdos-shell-fix.el</SPAN>
and 
<SPAN class=compcode>w32-shellex.el</SPAN>
both installed in your 
<SPAN class=compcode>site-lisp</SPAN>
directory. They make 
<SPAN class=compcode>command.com</SPAN>
more bearable on Windows 95/98. If you installed Emacs from the CD-ROM, you
already have them installed. To make them <A name="Index537"></A><A name="Index538"></A><A name="Index539"></A><A name="Index540"></A><A name="Index541"></A>effective,
add the following to your 
<SPAN class=compcode>.emacs</SPAN>
file:
</FONT></P>

<PRE class="compcode"><FONT size=3>
<SPAN class=compcode> (if (memq window-system &#039;(win32 w32))    ; Windows NT/95 </SPAN>
<SPAN class=compcode>    (progn </SPAN>
<SPAN class=compcode> </SPAN>
<SPAN class=compcode>      ;; add w32-shellex. </SPAN>
<SPAN class=compcode>      (require &#039;w32-shellex) </SPAN>
<SPAN class=compcode> </SPAN>
<SPAN class=compcode>      ;; NT Emacs on W95 has a problem leaving command.com as a </SPAN>
<SPAN class=compcode>      ;; orphan process when Emacs is shut down. This fixes that  </SPAN>
<SPAN class=compcode>      ;; problem, It appears to be harmless on NT. </SPAN>
<SPAN class=compcode> </SPAN>
<SPAN class=compcode>      (add-hook &#039;comint-exec-hook </SPAN>
<SPAN class=compcode>        (function (lambda () (require &#039;msdos-shell-fix)))) </SPAN>
<SPAN class=compcode> </SPAN>
<SPAN class=compcode>      ))<A name="Index542"></A><A name="Index543"></A><A name="Index544"></A><A name="Index545"></A><A name="Index546"></A> </SPAN>
</FONT></PRE>
<TABLE border="0" width="99%" cellspacing="0" cellpadding="3">
  <TR> 
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif"  bgcolor="#666699"> 
      <P> <FONT color="#FFFFFF"><B>Sams Teach Yourself Emacs<FONT size="1"></FONT> 
        in 24 Hours</B> </FONT></P>
    </TD>
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif" bgcolor="#666699"><FONT size="2"><IMG src="../style/dot.gif" tppabs="http://freebooks.by.ru/view/style/dot.gif" width="10" height="1"></FONT></TD>
    <TD background="graphics/blstrbkg.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/blstrbkg.gif" bgcolor="#666699" nowrap align="right"> 
      <P><A href="index.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/index.htm"><FONT size="2" color="#FFFFFF">Contents</FONT></A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="bkindex.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/bkindex.htm"><FONT size="2" color="#FFFFFF">Index</FONT></A></P>
    </TD>
  </TR>
  <TR> 
    <TD bgcolor="#AAAAAA" height="16"> 
      <P><FONT size="2">Hour 2: Using Emacs in Microsoft Windows</FONT></P>
    </TD>
    <TD bgcolor="#AAAAAA" height="16"><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
    <TD bgcolor="#AAAAAA" height="16" align="right" nowrap> 
      <P><FONT size="2"><A href="emacs010.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs010.htm"><IMG src="graphics/prev-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/prev-on.gif" width="7" height="5" border="0">Previous 
        Hour</A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="emacs025.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs025.htm">Next 
        Hour<IMG src="graphics/next-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/next-on.gif" width="7" height="5" border="0"></A></FONT></P>
    </TD>
  </TR>
  <TR> 
    <TD bgcolor="#DDDDDD"> 
      <TABLE border="0" cellspacing="0" cellpadding="0" dwcopytype="CopyTableRow">
        <TR valign="top"> 
          <TD> 
            <P></P>
            <P><FONT size="2">Sections in this Hour:</FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs016.htm#c1" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs016.htm#c1">What 
              Is NT Emacs?</A> </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs020.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs020.htm">How to 
              Tell Which Computer You Are On</A> </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs017.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs017.htm">Needed 
              Directories</A></FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs021.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs021.htm">Summary</A> 
              </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs018.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs018.htm">Setting 
              Up for Printing</A> </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs022.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs022.htm">Q&amp;A</A> 
              </FONT></P>
          </TD>
        </TR>
        <TR valign="top"> 
          <TD> 
            <P class="navigation"><FONT size="1">Things NT Emacs Does Not Do Well 
              </FONT></P>
          </TD>
          <TD><FONT size="2"><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"></FONT></TD>
          <TD> 
            <P class="navigation"><FONT size="1"><A href="emacs023.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs023.htm">Exercises</A> 
              </FONT></P>
          </TD>
        </TR>
      </TABLE>
    </TD>
    <TD bgcolor="#DDDDDD">&nbsp;</TD>
    <TD bgcolor="#DDDDDD" align="right" nowrap valign="bottom"> 
      <P class="navigation"><FONT size="2"><A href="emacs018.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs018.htm"><IMG src="graphics/prev-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/prev-on.gif" width="7" height="5" border="0">Previous 
        Section</A><IMG src="graphics/dot.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/dot.gif" width="10" height="1"><A href="emacs020.htm" tppabs="http://freebooks.by.ru/view/EmacsIn24h/emacs020.htm">Next 
        Section<IMG src="graphics/next-on.gif" tppabs="http://freebooks.by.ru/view/EmacsIn24h/graphics/next-on.gif" width="7" height="5" border="0"></A></FONT></P>
    </TD>
  </TR>
</TABLE>
<P class="copyright"><FONT size=2>&#169; Copyright Macmillan USA. All rights reserved.</FONT> 
</P>
</BODY>

</HTML>
